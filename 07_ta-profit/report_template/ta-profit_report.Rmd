---
title: "Trade-off Analysis Profit Report"
output: 
  html_document:
    toc: true
    toc_float: true
    number_sections: true
    df_print: kable
params:
  session_log: NA
  map_carbon1: NA
  map_carbon2: NA
  emission_map: NA
  opcost_map: NA
  opcost_table: NA
  opcost_curve: NA
  npv1_map: NA
  npv2_map: NA
  delta_npv: NA
  map1_file_path: NULL
  map2_file_path: NULL
  npv_file_path: NULL
  carbon_file_path: NULL
  year1: NULL
  year2: NULL
  raster_nodata: NULL
  output_dir: NULL
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(knitr)
library(kableExtra)
library(tidyr)
library(pkgdown)
library(ggplot2)
```

<details><summary>Click here for Analysis Log</summary>

```{r analysis-log, echo=FALSE}

analysis_log <- tribble(
  ~Category,                   ~Details,
  # "Analysis Start",        params$start_time,
  # "Analysis End",          params$end_time,
  "Input Data and Parameters", "",
  "Land Cover (t1)",      params$map1_file_path,
  "Land Cover (t2)",   params$map2_file_path,
  "Profitability data",   params$npv_file_path,
  "Carbon stock data",   params$carbon_file_path,
  "Year 1", as.character(params$year1),
  "Year 2", as.character(params$year2),
  "NoData land-cover class", as.character(params$raster_nodata),
  "Output Files", "",
  "Output Workspace",      paste0(getwd(), " | ", params$output_dir),
  "Session Summary", "",
) %>% rbind(format_session_info_table())

analysis_log %>% kbl(caption = "Analysis Log", escape = FALSE) %>%
  kable_paper("hover", full_width = F )
```
</details>

## Introduction

This report presents the results of an analysis based on the provided maps and lookup table

## Lookup Table Summary


* A brief description or summary statistics of the lookup table data can be included here.


## Analysis Results

The maps provided was carbon, emission and sequestration map.

* Calculation or analysis details based on the results can be presented here.

### Opportunity Cost Table

```{r, echo=FALSE, warning=FALSE, message=FALSE}
head(params$opcost_table, n=10)
```

### Opportunity Cost Curve
```{r, echo=FALSE, warning=FALSE, message=FALSE}
plot(params$opcost_curve)
```

### NPV Map 1

```{r, echo=FALSE, warning=FALSE, message=FALSE}
plot(params$npv1_map)
```

### NPV Map 2
```{r, echo=FALSE, warning=FALSE, message=FALSE}
plot(params$npv2_map)
```

### Delta NPV Map

```{r, echo=FALSE, warning=FALSE, message=FALSE}
# plot(params$delta_npv)
color_palette <- c("darkred", "white", "darkgreen")
plot(params$delta_npv, 
       col = color_palette,   
       colNA = "grey",        
       main = "NPV Change",
       legend.args = list(text = NULL, side = 4, font = 2, line = 2.5, cex = 1.2))
```

## Conclusion

* Summarize the key findings or insights from the analysis.
